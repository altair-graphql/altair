<div class="content-container">
  <div class="content-area app-content-area">
    <div class="window-loader window-loader--show" [ngClass]="{ 'window-loader--show': isLoading$ | async }">
      <div class="window-loader__content">
        <img src="assets/img/logo.svg" alt="" class="anim anim-rotate"> {{ 'LOADING_INDICATOR_TEXT' | translate }}
        <div class="window-loader__actions">
          <button class="app-button cancel-request-button" (click)="cancelRequest()" track-id="cancel_request">{{ 'CANCEL_TEXT' | translate }}</button>
        </div>
      </div>
    </div>
    <app-url-box
      [apiUrl]="apiUrl"
      [httpVerb]="httpVerb"
      [isSubscribed]="isSubscribed$ | async"
      [showDocs]="showDocs$ | async"
      [selectedOperation]="selectedOperation$ | async"
      [queryOperations]="queryOperations$ | async"

      (urlChange)="setApiUrl($event)"
      (httpVerbChange)="setApiMethod($event)"
      (sendRequest)="sendRequest()"
      (toggleDocsChange)="toggleDocs()"
      (reloadDocsChange)="reloadDocs()"
      (selectedOperationChange)="selectOperation($event)"
    ></app-url-box>
    <div class="main-content-area">
      <div class="row main-content-row" data-resize-container>
        <app-query-editor
          #queryEditor
          (queryChange)="updateQuery($event)"
          (sendRequest)="sendRequest()"
          (variablesChange)="updateVariables($event)"
          (toggleVariableDialog)="toggleVariableDialog($event)"
          [query]="query"
          [gqlSchema]="gqlSchema"
          [tabSize]="tabSize$ | async"
          [variables]="variables$ | async"
          [showVariableDialog]="showVariableDialog"
        ></app-query-editor>
        <app-query-result
          [queryResult]="queryResult$ | async"
          [responseTime]="responseTime$ | async"
          [responseStatus]="responseStatus$ | async"
          [responseStatusText]="responseStatusText$ | async"
          [isSubscribed]="isSubscribed$ | async"
          [subscriptionResponses]="subscriptionResponses$ | async"
          [subscriptionUrl]="subscriptionUrl"

          (downloadResultChange)="downloadResult()"
          (stopSubscriptionChange)="stopSubscription()"
          (clearSubscriptionChange)="clearSubscription()"
        ></app-query-result>
        <app-doc-viewer
          [gqlSchema]="gqlSchema"
          [allowIntrospection]="allowIntrospection$ | async"
          [ngClass]="{'hide-doc': !(showDocs$ | async)}"
          [isLoading]="docsIsLoading$ | async"
          [addQueryDepthLimit] = "addQueryDepthLimit$ | async"
          [tabSize]="tabSize$ | async"
          (toggleDocsChange)="toggleDocs()"
          (addQueryToEditorChange)="addQueryToEditor($event)"
          (exportSDLChange)="exportSDL()"
        ></app-doc-viewer>
      </div>
    </div>
    <div class="dialogs">
      <clr-modal [clrModalOpen]="showHeaderDialog" (clrModalOpenChange)="toggleHeader($event)">
        <h3 class="modal-title">
          <div class="app-dialog-header">
            <div class="app-dialog-title">{{ 'HEADERS_TEXT' | translate }}</div>
            {{ 'SET_HEADERS_DIALOG_SUBTEXT' | translate }}
          </div>
        </h3>
        <div class="modal-body">
          <div class="app-dialog-body">
            <div class="set-header-input-container" *ngFor="let header of headers$ | async;trackBy:trackByFn; let i = index">
              <div class="set-header-input-column">
                <input type="text" class="set-header-input" placeholder="Header key" value="{{header.key}}" (input)="headerKeyChange($event, i)">
              </div>
              <div class="set-header-input-column">
                <input type="text" class="set-header-input" placeholder="Header value" value="{{header.value}}" (input)="headerValueChange($event, i)">
              </div>
              <button class="header-input-remove-button" (click)="removeHeader(i)">&times;</button>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="app-dialog-footer">
            <button track-id="add_header" class="app-button active-grey left" (click)="addHeader()">{{ 'ADD_HEADER_TEXT' | translate }}</button>
            <button class="app-button active-primary right" (click)="toggleHeader($event)">{{ 'SAVE_BUTTON' | translate }}</button>
          </div>
        </div>
      </clr-modal>
      <!-- <app-set-variable-dialog
        [variables]="variables$ | async"
        [showVariableDialog]="showVariableDialog"
        (toggleVariableDialog)="toggleVariableDialog($event)"
        (variablesChange)="updateVariables($event)"
      ></app-set-variable-dialog> -->
      <app-subscription-url-dialog
        [subscriptionUrl]="subscriptionUrl"
        [showDialog]="showSubscriptionUrlDialog"
        (toggleDialogChange)="toggleSubscriptionUrlDialog($event)"
        (subscriptionUrlChange)="updateSubscriptionUrl($event)"
      ></app-subscription-url-dialog>
      <app-history-dialog
        [historyList]="historyList"
        [showDialog]="showHistoryDialog"
        (toggleDialogChange)="toggleHistoryDialog($event)"
        (restoreHistoryChange)="restoreHistory($event)"
      ></app-history-dialog>
    </div>
  </div>
  <!-- <nav class="sidenav">
    ...
  </nav> -->

  <div class="app-side-menu">
    <a class="side-menu-item" (click)="prettifyCode()" title="{{ 'PRETTIFY_BUTTON' | translate }}" track-id="prettify">
      <div class="side-menu-item-icon">
        <clr-icon shape="wand"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'PRETTIFY_BUTTON' | translate }}
      </div>
    </a>
    <a class="side-menu-item" (click)="compressQuery()" title="{{ 'COMPRESS_QUERY_BUTTON' | translate }}" track-id="compress_query">
      <div class="side-menu-item-icon">
        <clr-icon shape="shrink"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'COMPRESS_QUERY_BUTTON' | translate }}
      </div>
    </a>
    <a class="side-menu-item" (click)="clearEditor()" title="{{ 'CLEAR_BUTTON' | translate }}" track-id="clear">
      <div class="side-menu-item-icon">
        <clr-icon shape="trash"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'CLEAR_BUTTON' | translate }}
      </div>
    </a>
    <div class="side-menu-divider"></div>
    <a class="side-menu-item" (click)="toggleHeader(true)" title="{{ 'SET_HEADERS_BUTTON' | translate }}" track-id="show_set_headers">
      <div class="side-menu-item-icon">
        <clr-icon shape="asterisk"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'SET_HEADERS_BUTTON' | translate }}
      </div>
    </a>
    <a class="side-menu-item" (click)="toggleVariableDialog()" title="{{ 'SET_VARIABLES_BUTTON' | translate }}" track-id="show_set_variables">
      <div class="side-menu-item-icon">
        <clr-icon shape="blocks-group"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'SET_VARIABLES_BUTTON' | translate }}
      </div>
    </a>
    <a class="side-menu-item" (click)="toggleSubscriptionUrlDialog(true)" title="{{ 'SUBSCRIPTION_URL_TEXT' | translate }}" track-id="show_set_subscription_url">
      <div class="side-menu-item-icon">
        <clr-icon shape="switch"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'SUBSCRIPTION_URL_TEXT' | translate }}
      </div>
    </a>
    <a class="side-menu-item" (click)="toggleHistoryDialog(true)" title="{{ 'HISTORY_TEXT' | translate }}" track-id="show_history">
      <div class="side-menu-item-icon">
        <clr-icon shape="history"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'HISTORY_TEXT' | translate }}
      </div>
    </a>
    <div class="side-menu-divider"></div>
    <a class="side-menu-item" (click)="exportWindowData()" title="{{ 'EXPORT_WINDOW_TEXT' | translate }}" track-id="export_window">
      <div class="side-menu-item-icon">
        <clr-icon shape="export"></clr-icon>
      </div>
      <div class="side-menu-item-label">
        {{ 'EXPORT_WINDOW_TEXT' | translate }}
      </div>
    </a>
  </div>
</div>
